<p>매개변수 및 데이터 값과 관련된 일반적인 문제는 Spring Framework의 JDBC 지원이 제공하는 다양한 접근 방식에 존재합니다. 이 섹션에서는 이를 해결하는 방법을 다룹니다.</p>
<h1 id="providing-sql-type-information-for-parameters">Providing SQL Type Information for Parameters</h1>
<p>일반적으로 Spring은 전달된 매개변수의 타입에 따라 매개변수의 SQL 타입을 결정합니다. 매개변수 값을 설정할 때 사용할 SQL 유형을 명시적으로 제공하는 것이 가능합니다. <code>NULL</code> 값을 올바르게 설정하는 데 필요한 경우가 있습니다.</p>
<p>여러 가지 방법으로 SQL 타입 정보를 제공할 수 있습니다.</p>
<ul>
<li>
<p><code>JdbcTemplate</code>의 많은 업데이트 및 쿼리 메소드는 <code>int</code> 배열 형식의 추가 매개변수를 사용합니다. 이 배열은 <code>java.sql.Types</code> 클래스의 상수 값을 사용하여 해당 매개변수의 SQL 타입을 나타내는 데 사용됩니다. 각 매개변수에 대해 하나의 항목(entry)을 제공하십시오.</p>
</li>
<li>
<p><code>SqlParameterValue</code> 클래스를 사용하여 이 추가 정보가 필요한 매개 변수 값을 래핑할 수 있습니다. 이렇게 하려면 각 값에 대해 새 인스턴스를 만들고 생성자에 SQL 타입과 매개변수 값을 전달합니다. 숫자 값에 대한 optional scale 매개변수를 제공할 수도 있습니다.</p>
</li>
<li>
<p>명명된 매개 변수와 함께 작동하는 메서드의 경우 <code>SqlParameterSource</code> 클래스, <code>BeanPropertySqlParameterSource</code> 또는 <code>MapSqlParameterSource</code>를 사용할 수 있습니다. 두 가지 모두 명명된 매개변수 값에 대해 SQL 유형을 등록하는 방법을 가지고 있습니다.</p>
</li>
</ul>
<h1 id="handling-blob-and-clob-objects">Handling BLOB and CLOB objects</h1>
<p>이미지, 기타 바이너리 데이터, 대량의 텍스트를 데이터베이스에 저장할 수 있습니다. 이러한 대형 객체를 바이너리 데이터의 경우 BLOB(Binary Large OBject), 문자 데이터의 경우 CLOB(Character Large OBject)라고 합니다. Spring에서는 <code>JdbcTemplate</code>을 직접 사용하거나 RDBMS 객체 및 <code>SimpleJdbc</code> 클래스에서 제공하는 더 높은 추상화를 사용하여 이러한 대형 객체를 처리할 수 있습니다. 이러한 접근 방식은 모두 LOB(Large OBject) 데이터의 실제 관리를 위해 <code>LobHandler</code> 인터페이스 구현을 사용합니다. <code>LobHandler</code>는 삽입할 새 LOB 객체를 생성하는 데 사용되는 <code>getLobCreator</code> 메서드를 통해 <code>LobCreator</code> 클래스에 대한 액세스를 제공합니다.</p>
<p><code>LobCreator</code> 및 <code>LobHandler</code>는 LOB 입력 및 출력에 대해 다음 지원을 제공합니다.</p>
<ul>
<li>
<p>BLOB</p>
<ul>
<li><code>byte[]</code>: <code>getBlobAsBytes</code> 및 <code>setBlobAsBytes</code></li>
<li><code>InputStream</code>: <code>getBlobAsBinaryStream</code> 및 <code>setBlobAsBinaryStream</code></li>
</ul>
</li>
<li>
<p>CLOB</p>
<ul>
<li><code>String</code> : <code>getClobAsString</code> 및 <code>setClobAsString</code></li>
<li><code>InputStream</code>: <code>getClobAsAsciiStream</code> 및 <code>setClobAsAsciiStream</code></li>
<li><code>Reader</code> : <code>getClobAsCharacterStream</code> 및 <code>setClobAsCharacterStream</code></li>
</ul>
</li>
</ul>
<p>다음 예에서는 BLOB를 만들고 삽입하는 방법을 보여줍니다. 나중에 데이터베이스에서 다시 읽는 방법을 보여줍니다.</p>
<p>이 예제에서는 <code>JdbcTemplate</code>과 <code>AbstractLobCreatingPreparedStatementCallback</code> 구현을 사용합니다. 이는 <code>setValues</code>라는 하나의 메소드를 구현합니다. 이 메소드는 SQL 삽입 문에서 LOB 열의 값을 설정하는 데 사용하는 <code>LobCreator</code>를 제공합니다.</p>
<p>이 예에서는 이미 <code>DefaultLobHandler</code>의 인스턴스로 설정된 <code>lobHandler</code> 변수가 있다고 가정합니다. 일반적으로 종속성 주입을 통해 이 값을 설정합니다.</p>
<p>다음 예에서는 BLOB를 만들고 삽입하는 방법을 보여줍니다.</p>
<pre><code class="language-java"><span class="token keyword">final</span> <span class="token class-name">File</span> blobIn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"spring2004.jpg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">final</span> <span class="token class-name">InputStream</span> blobIs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>blobIn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">final</span> <span class="token class-name">File</span> clobIn <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"large.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">final</span> <span class="token class-name">InputStream</span> clobIs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileInputStream</span><span class="token punctuation">(</span>clobIn<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">final</span> <span class="token class-name">InputStreamReader</span> clobReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">InputStreamReader</span><span class="token punctuation">(</span>clobIs<span class="token punctuation">)</span><span class="token punctuation">;</span>

jdbcTemplate<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>
	<span class="token string">"INSERT INTO lob_table (id, a_clob, a_blob) VALUES (?, ?, ?)"</span><span class="token punctuation">,</span>
	<span class="token keyword">new</span> <span class="token class-name">AbstractLobCreatingPreparedStatementCallback</span><span class="token punctuation">(</span>lobHandler<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// (1)</span>
		<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">setValues</span><span class="token punctuation">(</span><span class="token class-name">PreparedStatement</span> ps<span class="token punctuation">,</span> <span class="token class-name">LobCreator</span> lobCreator<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
			ps<span class="token punctuation">.</span><span class="token function">setLong</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			lobCreator<span class="token punctuation">.</span><span class="token function">setClobAsCharacterStream</span><span class="token punctuation">(</span>ps<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> clobReader<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>clobIn<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// (2)</span>
			lobCreator<span class="token punctuation">.</span><span class="token function">setBlobAsBinaryStream</span><span class="token punctuation">(</span>ps<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> blobIs<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span>blobIn<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// (3)</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

blobIs<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
clobReader<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>(1) (이 예에서는) 일반 <code>DefaultLobHandler</code>인 <code>lobHandler</code>를 전달합니다.<br>
(2) <code>setClobAsCharacterStream</code> 메소드를 사용하여 CLOB의 컨텐츠를 전달합니다.<br>
(3) <code>setBlobAsBinaryStream</code> 메소드를 사용하여 BLOB의 내용을 전달합니다.</p>
<blockquote>
<p><strong>Note</strong><br>
<code>DefaultLobHandler.getLobCreator()</code>에서 반환된 <code>LobCreator</code>에서 <code>setBlobAsBinaryStream</code>, <code>setClobAsAsciiStream</code> 또는 <code>setClobAsCharacterStream</code> 메서드를 호출하는 경우 선택적으로 <code>contentLength</code> 인수에 음수 값을 지정할 수 있습니다. 지정된 컨텐츠 길이가 음수인 경우 <code>DefaultLobHandler</code>는 길이 매개변수 없이 set-stream 메소드의 JDBC 4.0 변형을 사용합니다. 그렇지 않으면 지정된 길이를 드라이버에 전달합니다.</p>
<p>콘텐츠 길이를 제공하지 않고 LOB 스트리밍을 지원하는지 확인하려면 사용하는 JDBC 드라이버에 대한 설명서를 참조하세요.</p>
</blockquote>
<p>이제 데이터베이스에서 LOB 데이터를 읽을 차례입니다. 이번에도 동일한 인스턴스 변수 <code>lobHandler</code>와 <code>DefaultLobHandler</code>에 대한 참조가 있는 <code>JdbcTemplate</code>을 사용합니다. 다음 예에서는 그 방법을 보여줍니다.</p>
<pre><code class="language-java"><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> l <span class="token operator">=</span> jdbcTemplate<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string">"select id, a_clob, a_blob from lob_table"</span><span class="token punctuation">,</span>
	<span class="token keyword">new</span> <span class="token class-name">RowMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">public</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">mapRow</span><span class="token punctuation">(</span><span class="token class-name">ResultSet</span> rs<span class="token punctuation">,</span> <span class="token keyword">int</span> i<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
			<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> results <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token class-name">String</span> clobText <span class="token operator">=</span> lobHandler<span class="token punctuation">.</span><span class="token function">getClobAsString</span><span class="token punctuation">(</span>rs<span class="token punctuation">,</span> <span class="token string">"a_clob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// (1)</span>
			results<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"CLOB"</span><span class="token punctuation">,</span> clobText<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> blobBytes <span class="token operator">=</span> lobHandler<span class="token punctuation">.</span><span class="token function">getBlobAsBytes</span><span class="token punctuation">(</span>rs<span class="token punctuation">,</span> <span class="token string">"a_blob"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// (2)</span>
			results<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"BLOB"</span><span class="token punctuation">,</span> blobBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token keyword">return</span> results<span class="token punctuation">;</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>(1) <code>getClobAsString</code> 메소드를 사용하여 CLOB의 컨텐츠를 검색합니다.<br>
(2) <code>getBlobAsBytes</code> 메소드를 사용하여 BLOB의 컨텐츠를 검색합니다.</p>
<h1 id="passing-in-lists-of-values-for-in-clause">Passing in Lists of Values for IN Clause</h1>
<p>SQL 표준에서는 변수 값 목록을 포함하는 표현식을 기반으로 행을 선택할 수 있습니다. 일반적인 예는 <code>select * from T_ACTOR where id in (1, 2, 3)</code> 입니다. 이 변수 목록은 JDBC 표준에 의해 준비된 명령문에 대해 직접 지원되지 않습니다. 가변 개수의 자리 표시자를 선언할 수 없습니다. 원하는 수의 자리 표시자를 준비한 다양한 변형이 필요하거나 필요한 자리 표시자 수를 알고 나서 SQL 문자열을 동적으로 생성해야 합니다. <code>NamedParameterJdbcTemplate</code>에서 제공되는 명명된 매개변수 지원은 후자의 접근 방식을 취합니다. 간단한 값의 <code>java.util.List</code>(또는 <code>Iterable</code>)로 값을 전달할 수 있습니다. 이 목록은 실제 SQL 문에 필요한 자리 표시자를 삽입하고 statement 실행 중에 값을 전달하는 데 사용됩니다.</p>
<blockquote>
<p><strong>[Note]</strong><br>
많은 값을 전달할 때는 주의하세요. JDBC 표준은 <code>IN</code> 표현식 목록에 100개가 넘는 값을 사용할 수 있다고 보장하지 않습니다. 다양한 데이터베이스가 이 숫자를 초과하지만 일반적으로 허용되는 값 수에 대한 엄격한 제한이 있습니다. 예를 들어 Oracle의 한도는 1000입니다.</p>
</blockquote>
<p>값 목록의 기본 값 외에도 객체 배열의 <code>java.util.List</code>를 생성할 수 있습니다. 이 목록은 <code>in</code> 절에 대해 정의되는 여러 표현식을 지원할 수 있습니다(예: <code>select * from T_ACTOR where (id, last_name) in ((1, 'Johnson'), (2, 'Harrop'))</code>). 물론 이를 위해서는 데이터베이스가 이 구문을 지원해야 합니다.</p>
<h1 id="handling-complex-types-for-stored-procedure-calls">Handling Complex Types for Stored Procedure Calls</h1>
<p>저장된 프로시저를 호출할 때 데이터베이스에 특정한 복합 유형을 사용할 수 있는 경우가 있습니다. 이러한 유형을 수용하기 위해 Spring은 저장된 프로시저 호출에서 반환될 때 이를 처리하기 위한 <code>SqlReturnType</code>을 제공하고 저장된 프로시저에 매개변수로 전달될 때 <code>SqlTypeValue</code>를 제공합니다.</p>
<p><code>SqlReturnType</code> 인터페이스에는 구현해야 하는 단일 메서드(<code>getTypeValue</code>라는 이름)가 있습니다. 이 인터페이스는 <code>SqlOutParameter</code> 선언의 일부로 사용됩니다. 다음 예에서는 사용자 선언 타입 <code>ITEM_TYPE</code>의 Oracle <code>STRUCT</code> 객체 값을 반환하는 방법을 보여줍니다.</p>
<pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestItemStoredProcedure</span> <span class="token keyword">extends</span> <span class="token class-name">StoredProcedure</span> <span class="token punctuation">{</span>

	<span class="token keyword">public</span> <span class="token class-name">TestItemStoredProcedure</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token comment">// ...</span>
		<span class="token function">declareParameter</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SqlOutParameter</span><span class="token punctuation">(</span><span class="token string">"item"</span><span class="token punctuation">,</span> <span class="token class-name">OracleTypes</span><span class="token punctuation">.</span>STRUCT<span class="token punctuation">,</span> <span class="token string">"ITEM_TYPE"</span><span class="token punctuation">,</span>
			<span class="token punctuation">(</span><span class="token class-name">CallableStatement</span> cs<span class="token punctuation">,</span> <span class="token keyword">int</span> colIndx<span class="token punctuation">,</span> <span class="token keyword">int</span> sqlType<span class="token punctuation">,</span> <span class="token class-name">String</span> typeName<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
				<span class="token class-name">STRUCT</span> struct <span class="token operator">=</span> <span class="token punctuation">(</span>STRUCT<span class="token punctuation">)</span> cs<span class="token punctuation">.</span><span class="token function">getObject</span><span class="token punctuation">(</span>colIndx<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> attr <span class="token operator">=</span> struct<span class="token punctuation">.</span><span class="token function">getAttributes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token class-name">TestItem</span> item <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				item<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Number</span><span class="token punctuation">)</span> attr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">longValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				item<span class="token punctuation">.</span><span class="token function">setDescription</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> attr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				item<span class="token punctuation">.</span><span class="token function">setExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">(</span>java<span class="token punctuation">.</span>util<span class="token punctuation">.</span><span class="token class-name">Date</span><span class="token punctuation">)</span> attr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">return</span> item<span class="token punctuation">;</span>
			<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// ...</span>
	<span class="token punctuation">}</span></code></pre>
<p><code>SqlTypeValue</code>를 사용하여 Java 개체(예: <code>TestItem</code>)의 값을 저장된 프로시저에 전달할 수 있습니다. <code>SqlTypeValue</code> 인터페이스에는 구현해야 하는 단일 메서드(<code>createTypeValue</code>라는 이름)가 있습니다. 활성 연결이 전달되며 이를 사용하여 <code>StructDescriptor</code> 인스턴스 또는 <code>ArrayDescriptor</code> 인스턴스와 같은 데이터베이스별 개체를 생성할 수 있습니다. 다음 예제에서는 <code>StructDescriptor</code> 인스턴스를 만듭니다.</p>
<pre><code class="language-java"><span class="token keyword">final</span> <span class="token class-name">TestItem</span> testItem <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TestItem</span><span class="token punctuation">(</span><span class="token number">123L</span><span class="token punctuation">,</span> <span class="token string">"A test item"</span><span class="token punctuation">,</span>
		<span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">"yyyy-M-d"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">"2010-12-31"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token class-name">SqlTypeValue</span> value <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AbstractSqlTypeValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">protected</span> <span class="token class-name">Object</span> <span class="token function">createTypeValue</span><span class="token punctuation">(</span><span class="token class-name">Connection</span> conn<span class="token punctuation">,</span> <span class="token keyword">int</span> sqlType<span class="token punctuation">,</span> <span class="token class-name">String</span> typeName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
		<span class="token class-name">StructDescriptor</span> itemDescriptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StructDescriptor</span><span class="token punctuation">(</span>typeName<span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Struct</span> item <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">STRUCT</span><span class="token punctuation">(</span>itemDescriptor<span class="token punctuation">,</span> conn<span class="token punctuation">,</span>
		<span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
			testItem<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			testItem<span class="token punctuation">.</span><span class="token function">getDescription</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
			<span class="token keyword">new</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span><span class="token class-name">Date</span><span class="token punctuation">(</span>testItem<span class="token punctuation">.</span><span class="token function">getExpirationDate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> item<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>이제 저장된 프로시저의 <code>execute</code> 호출에 대한 입력 매개변수가 포함된 <code>Map</code>에 이 <code>SqlTypeValue</code>를 추가할 수 있습니다.</p>
<p><code>SqlTypeValue</code>의 또 다른 용도는 Oracle 저장된 프로시저에 값 배열을 전달하는 것입니다. Oracle에는 이 경우 사용해야 하는 자체 내부 <code>ARRAY</code> 클래스가 있으며, 다음 예제와 같이 <code>SqlTypeValue</code>를 사용하여 Oracle <code>ARRAY</code>의 인스턴스를 생성하고 Java <code>ARRAY</code>의 값으로 채울 수 있습니다.</p>
<pre><code class="language-java"><span class="token keyword">final</span> <span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> ids <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Long</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span><span class="token number">1L</span><span class="token punctuation">,</span> <span class="token number">2L</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token class-name">SqlTypeValue</span> value <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AbstractSqlTypeValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">protected</span> <span class="token class-name">Object</span> <span class="token function">createTypeValue</span><span class="token punctuation">(</span><span class="token class-name">Connection</span> conn<span class="token punctuation">,</span> <span class="token keyword">int</span> sqlType<span class="token punctuation">,</span> <span class="token class-name">String</span> typeName<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
		<span class="token class-name">ArrayDescriptor</span> arrayDescriptor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayDescriptor</span><span class="token punctuation">(</span>typeName<span class="token punctuation">,</span> conn<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">ARRAY</span> idArray <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token function">ARRAY</span><span class="token punctuation">(</span>arrayDescriptor<span class="token punctuation">,</span> conn<span class="token punctuation">,</span> ids<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> idArray<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>