<p><code>SimpleJdbcInsert</code> 및 <code>SimpleJdbcCall</code> 클래스는 JDBC 드라이버를 통해 검색할 수 있는 데이터베이스 메타데이터를 활용하여 단순화된 구성을 제공합니다. 즉, 코드에 모든 세부 정보를 제공하려는 경우 메타데이터 처리를 재정의하거나 끌 수 있지만 미리 구성할 항목이 적다는 것을 의미합니다.</p>
<h1 id="inserting-data-by-using-simplejdbcinsert">Inserting Data by Using <code>SimpleJdbcInsert</code></h1>
<p>최소한의 구성 옵션을 사용하여 <code>SimpleJdbcInsert</code> 클래스를 살펴보는 것부터 시작합니다. 데이터 액세스 계층의 초기화 메서드에서 <code>SimpleJdbcInsert</code>를 인스턴스화해야 합니다. 이 예에서 초기화 메소드는 <code>setDataSource</code> 메소드입니다. <code>SimpleJdbcInsert</code> 클래스를 서브클래싱할 필요는 없습니다. 대신 <code>withTableName</code> 메서드를 사용하여 새 인스턴스를 만들고 테이블 이름을 설정할 수 있습니다. 이 클래스의 구성 메서드는 모든 구성 메서드를 연결할 수 있는 <code>SimpleJdbcInsert</code>의 인스턴스를 반환하는 <code>fluid</code> 스타일을 따릅니다. 다음 예에서는 하나의 구성 메소드만 사용합니다(나중에 여러 메소드의 예를 보여줍니다).</p>
<pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcActorDao</span> <span class="token keyword">implements</span> <span class="token class-name">ActorDao</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token class-name">SimpleJdbcInsert</span> insertActor<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>insertActor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleJdbcInsert</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withTableName</span><span class="token punctuation">(</span><span class="token string">"t_actor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Actor</span> actor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> parameters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		parameters<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">,</span> actor<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		parameters<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"first_name"</span><span class="token punctuation">,</span> actor<span class="token punctuation">.</span><span class="token function">getFirstName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		parameters<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"last_name"</span><span class="token punctuation">,</span> actor<span class="token punctuation">.</span><span class="token function">getLastName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		insertActor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// ... additional methods</span>
<span class="token punctuation">}</span></code></pre>
<p>여기서 사용된 <code>execute</code> 메소드는 일반 <code>java.util.Map</code>을 유일한 매개변수로 사용합니다. 여기서 주목해야 할 중요한 점은 <code>Map</code>에 사용되는 키가 데이터베이스에 정의된 테이블의 열 이름과 일치해야 한다는 것입니다. 이는 실제 insert 문을 구성하기 위해 메타데이터를 읽기 때문입니다.</p>
<h1 id="retrieving-auto-generated-keys-by-using-simplejdbcinsert">Retrieving Auto-generated Keys by Using <code>SimpleJdbcInsert</code></h1>
<p>다음 예제에서는 이전 예제와 동일한 삽입을 사용하지만 <code>id</code>를 전달하는 대신 자동 생성 키를 검색하여 새 <code>Actor</code> 객체에 설정합니다. <code>SimpleJdbcInsert</code>를 생성할 때 테이블 이름을 지정하는 것 외에도 <code>usingGeneratedKeyColumns</code> 메서드를 사용하여 생성된 키 열의 이름을 지정합니다. 다음 목록은 작동 방식을 보여줍니다.</p>
<pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcActorDao</span> <span class="token keyword">implements</span> <span class="token class-name">ActorDao</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token class-name">SimpleJdbcInsert</span> insertActor<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>insertActor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleJdbcInsert</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">withTableName</span><span class="token punctuation">(</span><span class="token string">"t_actor"</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">usingGeneratedKeyColumns</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Actor</span> actor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> parameters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		parameters<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"first_name"</span><span class="token punctuation">,</span> actor<span class="token punctuation">.</span><span class="token function">getFirstName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		parameters<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"last_name"</span><span class="token punctuation">,</span> actor<span class="token punctuation">.</span><span class="token function">getLastName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Number</span> newId <span class="token operator">=</span> insertActor<span class="token punctuation">.</span><span class="token function">executeAndReturnKey</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token punctuation">;</span>
		actor<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>newId<span class="token punctuation">.</span><span class="token function">longValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// ... additional methods</span>
<span class="token punctuation">}</span></code></pre>
<p>이 두 번째 접근 방식을 사용하여 삽입을 실행할 때의 주요 차이점은 <code>Map</code>에 <code>id</code>를 추가하지 않고 <code>executeAndReturnKey</code> 메서드를 호출한다는 것입니다. 이는 도메인 클래스에서 사용되는 숫자 유형의 인스턴스를 생성할 수 있는 <code>java.lang.Number</code> 객체를 반환합니다. 여기에서 특정 Java 클래스를 반환하기 위해 모든 데이터베이스에 의존할 수는 없습니다. <code>java.lang.Number</code>는 신뢰할 수 있는 기본 클래스입니다. 자동 생성된 열이 여러 개 있거나 생성된 값이 숫자가 아닌 경우, <code>ExecuteAndReturnKeyHolder</code> 메소드에서 반환된 <code>KeyHolder</code>를 사용할 수 있습니다.</p>
<h1 id="specifying-columns-for-a-simplejdbcinsert">Specifying Columns for a <code>SimpleJdbcInsert</code></h1>
<p>다음 예제와 같이 <code>usingColumns</code> 메서드를 사용하여 열 이름 목록을 지정하여 삽입할 열을 제한할 수 있습니다.</p>
<pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcActorDao</span> <span class="token keyword">implements</span> <span class="token class-name">ActorDao</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token class-name">SimpleJdbcInsert</span> insertActor<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>insertActor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleJdbcInsert</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">withTableName</span><span class="token punctuation">(</span><span class="token string">"t_actor"</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">usingColumns</span><span class="token punctuation">(</span><span class="token string">"first_name"</span><span class="token punctuation">,</span> <span class="token string">"last_name"</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">usingGeneratedKeyColumns</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Actor</span> actor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> parameters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		parameters<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"first_name"</span><span class="token punctuation">,</span> actor<span class="token punctuation">.</span><span class="token function">getFirstName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		parameters<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"last_name"</span><span class="token punctuation">,</span> actor<span class="token punctuation">.</span><span class="token function">getLastName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Number</span> newId <span class="token operator">=</span> insertActor<span class="token punctuation">.</span><span class="token function">executeAndReturnKey</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token punctuation">;</span>
		actor<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>newId<span class="token punctuation">.</span><span class="token function">longValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// ... additional methods</span>
<span class="token punctuation">}</span></code></pre>
<p>삽입 실행은 메타데이터를 사용하여 사용할 열을 결정하는 것과 동일합니다.</p>
<h1 id="using-sqlparametersource-to-provide-parameter-values">Using <code>SqlParameterSource</code> to Provide Parameter Values</h1>
<p>매개변수 값을 제공하기 위해 <code>Map</code>을 사용하는 것은 잘 작동하지만 사용하기 가장 편리한 클래스는 아닙니다. Spring은 대신 사용할 수 있는 <code>SqlParameterSource</code> 인터페이스의 몇 가지 구현을 제공합니다. 첫 번째는 <code>BeanPropertySqlParameterSource</code>로, 값이 포함된 JavaBean 호환 클래스가 있는 경우 매우 편리한 클래스입니다. 해당 getter 메서드를 사용하여 매개변수 값을 추출합니다. 다음 예에서는 <code>BeanPropertySqlParameterSource</code>를 사용하는 방법을 보여줍니다.</p>
<pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcActorDao</span> <span class="token keyword">implements</span> <span class="token class-name">ActorDao</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token class-name">SimpleJdbcInsert</span> insertActor<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>insertActor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleJdbcInsert</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">withTableName</span><span class="token punctuation">(</span><span class="token string">"t_actor"</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">usingGeneratedKeyColumns</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Actor</span> actor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">SqlParameterSource</span> parameters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BeanPropertySqlParameterSource</span><span class="token punctuation">(</span>actor<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Number</span> newId <span class="token operator">=</span> insertActor<span class="token punctuation">.</span><span class="token function">executeAndReturnKey</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token punctuation">;</span>
		actor<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>newId<span class="token punctuation">.</span><span class="token function">longValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// ... additional methods</span>
<span class="token punctuation">}</span></code></pre>
<p>또 다른 옵션은 <code>Map</code>과 유사하지만 연결(chained)될 수 있는 더 편리한 <code>addValue</code> 메서드를 제공하는 <code>MapSqlParameterSource</code>입니다. 다음 예에서는 사용 방법을 보여줍니다.</p>
<pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcActorDao</span> <span class="token keyword">implements</span> <span class="token class-name">ActorDao</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token class-name">SimpleJdbcInsert</span> insertActor<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>insertActor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleJdbcInsert</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">withTableName</span><span class="token punctuation">(</span><span class="token string">"t_actor"</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">usingGeneratedKeyColumns</span><span class="token punctuation">(</span><span class="token string">"id"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token class-name">Actor</span> actor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">SqlParameterSource</span> parameters <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MapSqlParameterSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">addValue</span><span class="token punctuation">(</span><span class="token string">"first_name"</span><span class="token punctuation">,</span> actor<span class="token punctuation">.</span><span class="token function">getFirstName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">addValue</span><span class="token punctuation">(</span><span class="token string">"last_name"</span><span class="token punctuation">,</span> actor<span class="token punctuation">.</span><span class="token function">getLastName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Number</span> newId <span class="token operator">=</span> insertActor<span class="token punctuation">.</span><span class="token function">executeAndReturnKey</span><span class="token punctuation">(</span>parameters<span class="token punctuation">)</span><span class="token punctuation">;</span>
		actor<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>newId<span class="token punctuation">.</span><span class="token function">longValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// ... additional methods</span>
<span class="token punctuation">}</span></code></pre>
<p>보시다시피 구성은 동일합니다. 이러한 대체 입력 클래스를 사용하려면 실행 코드만 변경하면 됩니다.</p>
<h1 id="calling-a-stored-procedure-with-simplejdbccall">Calling a Stored Procedure with <code>SimpleJdbcCall</code></h1>
<p><code>SimpleJdbcCall</code> 클래스는 데이터베이스의 메타데이터를 사용하여 <code>in</code> 및 <code>out</code> 매개변수의 이름을 조회하므로 이를 명시적으로 선언할 필요가 없습니다. 이를 선호하거나 Java 클래스에 대한 자동 매핑이 없는 매개변수(예: <code>ARRAY</code> 또는 <code>STRUCT</code>)가 있는 경우 매개변수를 선언할 수 있습니다. 첫 번째 예는 MySQL 데이터베이스에서 <code>VARCHAR</code> 및 <code>DATE</code> 형식의 스칼라 값만 반환하는 간단한 프로시저를 보여줍니다. 예제 프로시저는 지정된 배우 항목을 읽고 <code>first_name</code>, <code>last_name</code> 및 <code>birthday_date</code> 열을 <code>out</code> 매개변수 형식으로 반환합니다. 다음 목록은 첫 번째 예를 보여줍니다.</p>
<pre><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> read_actor <span class="token punctuation">(</span>
	<span class="token operator">IN</span> in_id <span class="token keyword">INTEGER</span><span class="token punctuation">,</span>
	<span class="token keyword">OUT</span> out_first_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">OUT</span> out_last_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
	<span class="token keyword">OUT</span> out_birth_date <span class="token keyword">DATE</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
	<span class="token keyword">SELECT</span> first_name<span class="token punctuation">,</span> last_name<span class="token punctuation">,</span> birth_date
	<span class="token keyword">INTO</span> out_first_name<span class="token punctuation">,</span> out_last_name<span class="token punctuation">,</span> out_birth_date
	<span class="token keyword">FROM</span> t_actor <span class="token keyword">where</span> id <span class="token operator">=</span> in_id<span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span></code></pre>
<p><code>in_id</code> 매개변수에는 조회 중인 행위자의 <code>id</code>가 포함됩니다. <code>out</code> 매개변수는 테이블에서 읽은 데이터를 반환합니다.</p>
<p><code>SimpleJdbcInsert</code>를 선언하는 것과 유사한 방식으로 <code>SimpleJdbcCall</code>을 선언할 수 있습니다. 데이터 액세스 계층의 초기화 메서드에서 클래스를 인스턴스화하고 구성해야 합니다. <code>StoredProcedure</code> 클래스와 비교하면 하위 클래스를 생성할 필요가 없으며 데이터베이스 메타데이터에서 조회할 수 있는 매개 변수를 선언할 필요도 없습니다. 다음 <code>SimpleJdbcCall</code> 구성 예에서는 이전 저장된 프로시저를 사용합니다(<code>DataSource</code> 외에 유일한 구성 옵션은 저장된 프로시저의 이름입니다).</p>
<pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcActorDao</span> <span class="token keyword">implements</span> <span class="token class-name">ActorDao</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token class-name">SimpleJdbcCall</span> procReadActor<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>procReadActor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleJdbcCall</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">withProcedureName</span><span class="token punctuation">(</span><span class="token string">"read_actor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token class-name">Actor</span> <span class="token function">readActor</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">SqlParameterSource</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MapSqlParameterSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">addValue</span><span class="token punctuation">(</span><span class="token string">"in_id"</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Map</span> out <span class="token operator">=</span> procReadActor<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">Actor</span> actor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Actor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		actor<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
		actor<span class="token punctuation">.</span><span class="token function">setFirstName</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> out<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"out_first_name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		actor<span class="token punctuation">.</span><span class="token function">setLastName</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span> out<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"out_last_name"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		actor<span class="token punctuation">.</span><span class="token function">setBirthDate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Date</span><span class="token punctuation">)</span> out<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"out_birth_date"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> actor<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// ... additional methods</span>
<span class="token punctuation">}</span></code></pre>
<p>호출 실행을 위해 작성하는 코드에는 IN 매개 변수가 포함된 <code>SqlParameterSource</code>를 만드는 작업이 포함됩니다. 입력 값에 제공된 이름은 저장된 프로시저에 선언된 매개변수 이름과 일치해야 합니다. 메타데이터를 사용하여 저장된  프로시저에서 데이터베이스 개체를 참조하는 방법을 결정하므로 대소문자(case)가 일치할 필요는 없습니다. 저장된 프로시저의 소스에 지정된 내용이 반드시 데이터베이스에 저장되는 방식은 아닙니다. 일부 데이터베이스는 이름을 모두 대문자로 변환하는 반면 다른 데이터베이스는 소문자를 사용하거나 지정된 대로 대소문자를 사용합니다.</p>
<p><code>execute</code> 메소드는 IN 매개변수를 취하고 저장된 프로시저에 지정된 이름으로 입력된 모든 <code>out</code> 매개변수를 포함하는 <code>Map</code>을 반환합니다. 이 경우에는 <code>out_first_name</code>, <code>out_last_name</code>, <code>out_birth_date</code>입니다.</p>
<p><code>execute</code> 메소드의 마지막 부분은 검색된 데이터를 반환하는 데 사용할 <code>Actor</code> 인스턴스를 생성합니다. 여기서도 저장된 프로시저에 선언된 <code>out</code> 매개변수의 이름을 사용하는 것이 중요합니다. 또한 결과 맵에 저장된 <code>out</code> 매개변수 이름의 대소문자는 데이터베이스에 있는 <code>out</code> 매개변수 이름의 대소문자와 일치하며 이는 데이터베이스마다 다를 수 있습니다. 코드의 이식성(portable)을 높이려면 대소문자를 구분하지 않는(case-insensitive) 조회를 수행하거나 Spring에 <code>LinkedCaseInsensitiveMap</code>을 사용하도록 지시해야 합니다. 후자를 수행하려면 자신만의 <code>JdbcTemplate</code>을 만들고 <code>setResultsMapCaseInsensitive</code> 속성을 <code>true</code>로 설정하면 됩니다. 그런 다음 이 사용자 정의된 <code>JdbcTemplate</code> 인스턴스를 <code>SimpleJdbcCall</code>의 생성자에 전달할 수 있습니다. 다음 예에서는 이 구성을 보여줍니다.</p>
<pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcActorDao</span> <span class="token keyword">implements</span> <span class="token class-name">ActorDao</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token class-name">SimpleJdbcCall</span> procReadActor<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">JdbcTemplate</span> jdbcTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JdbcTemplate</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
		jdbcTemplate<span class="token punctuation">.</span><span class="token function">setResultsMapCaseInsensitive</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>procReadActor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleJdbcCall</span><span class="token punctuation">(</span>jdbcTemplate<span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">withProcedureName</span><span class="token punctuation">(</span><span class="token string">"read_actor"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// ... additional methods</span>
<span class="token punctuation">}</span></code></pre>
<p>이 작업을 수행하면 반환된 <code>out</code> 매개변수의 이름에 사용되는 대소문자 충돌을 피할 수 있습니다.</p>
<h1 id="explicitly-declaring-parameters-to-use-for-a-simplejdbccall">Explicitly Declaring Parameters to Use for a <code>SimpleJdbcCall</code></h1>
<p>이 장 앞부분에서 매개변수가 메타데이터에서 추론되는(deduced from) 방법을 설명했지만 원하는 경우 매개변수를 명시적으로 선언할 수 있습니다. 가변 개수의 <code>SqlParameter</code> 개체를 입력으로 사용하는 <code>declareParameters</code> 메서드를 사용하여 <code>SimpleJdbcCall</code>을 만들고 구성하면 그렇게 할 수 있습니다. <code>SqlParameter</code>를 정의하는 방법에 대한 자세한 내용은 다음 섹션을 참조하세요.</p>
<blockquote>
<p><strong>[Note]</strong><br>
사용하는 데이터베이스가 Spring 지원 데이터베이스가 아닌 경우 명시적인 선언이 필요합니다. 현재 Spring은 Apache Derby, DB2, MySQL, Microsoft SQL Server, Oracle 및 Sybase 데이터베이스에 대한 저장된 프로시저 호출의 메타데이터 조회를 지원합니다. 또한 MySQL, Microsoft SQL Server 및 Oracle에 대한 저장된 함수의 메타데이터 조회도 지원합니다.</p>
</blockquote>
<p>매개변수 중 하나, 일부 또는 전부를 명시적으로 선언하도록 선택(opt to)할 수 있습니다. 매개변수 메타데이터는 매개변수를 명시적으로 선언하지 않은 경우에도 계속 사용됩니다. 잠재적 매개변수에 대한 메타데이터 조회의 모든 처리를 우회하고 선언된 매개변수만 사용하려면 선언의 일부로 <code>withoutProcedureColumnMetaDataAccess</code> 메소드를 호출할 수 있습니다. 데이터베이스 함수에 대해 두 개 이상의 서로 다른 호출 시그니처가 선언되어 있다고 가정합니다. 이 경우 <code>useInParameterNames</code>를 호출하여 주어진 시그니처에 포함할 IN 매개변수 이름 목록을 지정합니다.</p>
<p>다음 예에서는 완전히 선언된 프로시저 호출을 보여주고 이전 예의 정보를 사용합니다.</p>
<pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcActorDao</span> <span class="token keyword">implements</span> <span class="token class-name">ActorDao</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token class-name">SimpleJdbcCall</span> procReadActor<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">JdbcTemplate</span> jdbcTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JdbcTemplate</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
		jdbcTemplate<span class="token punctuation">.</span><span class="token function">setResultsMapCaseInsensitive</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>procReadActor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleJdbcCall</span><span class="token punctuation">(</span>jdbcTemplate<span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">withProcedureName</span><span class="token punctuation">(</span><span class="token string">"read_actor"</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">withoutProcedureColumnMetaDataAccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">useInParameterNames</span><span class="token punctuation">(</span><span class="token string">"in_id"</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">declareParameters</span><span class="token punctuation">(</span>
						<span class="token keyword">new</span> <span class="token class-name">SqlParameter</span><span class="token punctuation">(</span><span class="token string">"in_id"</span><span class="token punctuation">,</span> <span class="token class-name">Types</span><span class="token punctuation">.</span>NUMERIC<span class="token punctuation">)</span><span class="token punctuation">,</span>
						<span class="token keyword">new</span> <span class="token class-name">SqlOutParameter</span><span class="token punctuation">(</span><span class="token string">"out_first_name"</span><span class="token punctuation">,</span> <span class="token class-name">Types</span><span class="token punctuation">.</span>VARCHAR<span class="token punctuation">)</span><span class="token punctuation">,</span>
						<span class="token keyword">new</span> <span class="token class-name">SqlOutParameter</span><span class="token punctuation">(</span><span class="token string">"out_last_name"</span><span class="token punctuation">,</span> <span class="token class-name">Types</span><span class="token punctuation">.</span>VARCHAR<span class="token punctuation">)</span><span class="token punctuation">,</span>
						<span class="token keyword">new</span> <span class="token class-name">SqlOutParameter</span><span class="token punctuation">(</span><span class="token string">"out_birth_date"</span><span class="token punctuation">,</span> <span class="token class-name">Types</span><span class="token punctuation">.</span>DATE<span class="token punctuation">)</span>
				<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// ... additional methods</span>
<span class="token punctuation">}</span></code></pre>
<p>두 예제의 실행 및 최종 결과는 동일합니다. 두 번째 예에서는 메타데이터에 의존하지 않고 모든 세부 정보를 명시적으로 지정합니다</p>
<h1 id="how-to-define-sqlparameters">How to Define <code>SqlParameters</code></h1>
<p><code>SimpleJdb</code>c 클래스 및 RDBMS 작업 클래스(<a href="https://docs.spring.io/spring-framework/reference/data-access/jdbc/object.html">JDBC 작업을 Java 개체로 모델링하기</a>에서 다룸)에 대한 매개 변수를 정의하려면 <code>SqlParameter</code> 또는 그것의 하위 클래스 중 하나를 사용할 수 있습니다. 이렇게 하려면 일반적으로 생성자에서 매개변수 이름과 SQL 타입을 지정합니다. SQL 타입은 <code>java.sql.Types</code> 상수를 사용하여 지정됩니다. 이 장의 앞부분에서 다음과 유사한 선언을 보았습니다.</p>
<pre><code class="language-java"><span class="token keyword">new</span> <span class="token class-name">SqlParameter</span><span class="token punctuation">(</span><span class="token string">"in_id"</span><span class="token punctuation">,</span> <span class="token class-name">Types</span><span class="token punctuation">.</span>NUMERIC<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">new</span> <span class="token class-name">SqlOutParameter</span><span class="token punctuation">(</span><span class="token string">"out_first_name"</span><span class="token punctuation">,</span> <span class="token class-name">Types</span><span class="token punctuation">.</span>VARCHAR<span class="token punctuation">)</span><span class="token punctuation">,</span></code></pre>
<p><code>SqlParameter</code>가 있는 첫 번째 줄은 IN 매개 변수를 선언합니다. <code>SqlQuery</code> 및 해당 하위 클래스를 사용하여 저장된 프로시저 호출과 쿼리 모두에 IN 매개 변수를 사용할 수 있습니다(<a href="https://docs.spring.io/spring-framework/reference/data-access/jdbc/object.html#jdbc-SqlQuery">SqlQuery 이해하기</a>에서 다룹니다).</p>
<p>두 번째 줄(<code>SqlOutParameter</code> 포함)은 저장된 프로시저 호출에 사용할 <code>out</code> 매개 변수를 선언합니다. <code>InOut</code> 매개변수(프로시저에 IN 값을 제공하고 값도 반환하는 매개변수)에 대한 <code>SqlInOutParameter</code>도 있습니다.</p>
<blockquote>
<p><strong>[Note]</strong><br>
<code>SqlParameter</code> 및 <code>SqlInOutParameter</code>로 선언된 매개 변수만 입력 값을 제공하는 데 사용됩니다. 이는 이전 버전과의 호환성을 위해 <code>SqlOutParameter</code>로 선언된 매개 변수에 입력 값을 제공할 수 있는 <code>StoredProcedure</code> 클래스와 다릅니다.</p>
</blockquote>
<p>IN 매개변수의 경우, 이름 및 SQL 타입 외에도 숫자 데이터의 소수점 이하 자릿수 또는 사용자 정의 데이터베이스 타입의 타입 이름을 지정할 수 있습니다. <code>out</code> 매개변수의 경우 <code>REF</code> 커서에서 반환된 행 매핑을 처리하기 위해 <code>RowMapper</code>를 제공할 수 있습니다. 또 다른 옵션은 반환 값의 사용자 정의 처리를 정의할 수 있는 기회를 제공하는 <code>SqlReturnType</code>을 지정하는 것입니다.</p>
<h1 id="calling-a-stored-function-by-using-simplejdbccall">Calling a Stored Function by Using <code>SimpleJdbcCall</code></h1>
<p>프로시저 이름이 아닌 함수 이름을 제공한다는 점을 제외하면 저장된 프로시저를 호출하는 것과 거의 동일한 방식으로 저장된 함수를 호출할 수 있습니다. <code>withFunctionName</code> 메서드를 구성의 일부로 사용하여 함수 호출을 나타내면, 함수 호출에 해당하는 문자열이 생성됩니다. 특수 호출(<code>executeFunction</code>)은 함수를 실행하는 데 사용되며 함수 반환 값을 지정된 타입의 개체로 반환합니다. 즉, 결과 맵에서 반환 값을 검색할 필요가 없습니다. <code>out</code> 매개변수가 하나만 있는 저장된 프로시저에도 비슷한 편의 메서드(<code>executeObject</code>)를 사용할 수 있습니다. 다음 예제(MySQL용)는 actor의 전체 이름을 반환하는 <code>get_actor_name</code>이라는 저장된 함수를 기반으로 합니다.</p>
<pre><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">FUNCTION</span> get_actor_name <span class="token punctuation">(</span>in_id <span class="token keyword">INTEGER</span><span class="token punctuation">)</span>
<span class="token keyword">RETURNS</span> <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span> <span class="token keyword">READS</span> <span class="token keyword">SQL</span> <span class="token keyword">DATA</span>
<span class="token keyword">BEGIN</span>
	<span class="token keyword">DECLARE</span> out_name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token keyword">SELECT</span> concat<span class="token punctuation">(</span>first_name<span class="token punctuation">,</span> <span class="token string">' '</span><span class="token punctuation">,</span> last_name<span class="token punctuation">)</span>
		<span class="token keyword">INTO</span> out_name
		<span class="token keyword">FROM</span> t_actor <span class="token keyword">where</span> id <span class="token operator">=</span> in_id<span class="token punctuation">;</span>
	<span class="token keyword">RETURN</span> out_name<span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span></code></pre>
<p>이 함수를 호출하기 위해 다음 예제와 같이 초기화 메서드에서 <code>SimpleJdbcCall</code>을 다시 만듭니다.</p>
<pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcActorDao</span> <span class="token keyword">implements</span> <span class="token class-name">ActorDao</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token class-name">SimpleJdbcCall</span> funcGetActorName<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">JdbcTemplate</span> jdbcTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JdbcTemplate</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
		jdbcTemplate<span class="token punctuation">.</span><span class="token function">setResultsMapCaseInsensitive</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>funcGetActorName <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleJdbcCall</span><span class="token punctuation">(</span>jdbcTemplate<span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">withFunctionName</span><span class="token punctuation">(</span><span class="token string">"get_actor_name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getActorName</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">SqlParameterSource</span> in <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MapSqlParameterSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">addValue</span><span class="token punctuation">(</span><span class="token string">"in_id"</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token class-name">String</span> name <span class="token operator">=</span> funcGetActorName<span class="token punctuation">.</span><span class="token function">executeFunction</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> in<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> name<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// ... additional methods</span>
<span class="token punctuation">}</span></code></pre>
<p>사용된 <code>executionFunction</code> 메소드는 함수 호출의 반환 값이 포함된 <code>String</code>을 반환합니다.</p>
<h1 id="returning-a-resultset-or-ref-cursor-from-a-simplejdbccall">Returning a <code>ResultSet</code> or REF Cursor from a <code>SimpleJdbcCall</code></h1>
<p>결과 세트(result set)를 반환하는 저장된 프로시저나 함수를 호출하는 것은 약간 까다롭습니다. 일부 데이터베이스는 JDBC 결과 처리 중에 결과 세트를 반환하는 반면, 다른 데이터베이스는 특정 유형의 명시적으로 등록된 <code>out</code> 매개변수를 요구합니다. 두 접근 방식 모두 결과 집합(result set)을 반복(loop)하고 반환된 행을 처리하려면 추가 처리가 필요합니다. <code>SimpleJdbcCall</code>을 사용하면 <code>returningResultSet</code> 메소드를 사용하고 특정 매개변수에 사용할 <code>RowMapper</code> 구현을 선언할 수 있습니다. 결과 처리 중에 결과 집합(result set)이 반환되면 정의된 이름이 없으므로 반환된 결과는 <code>RowMapper</code> 구현을 선언한 순서와 일치해야 합니다. 지정된 이름은 <code>execute</code> 문에서 반환된 결과 맵(result map)에 처리된 결과 목록을 저장하는 데 계속 사용됩니다.</p>
<p>다음 예(MySQL용)에서는 IN 매개변수를 사용하지 않고 <code>t_actor</code> 테이블의 모든 행을 반환하는 저장된 프로시저를 사용합니다.</p>
<pre><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">PROCEDURE</span> read_all_actors<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">BEGIN</span>
 <span class="token keyword">SELECT</span> a<span class="token punctuation">.</span>id<span class="token punctuation">,</span> a<span class="token punctuation">.</span>first_name<span class="token punctuation">,</span> a<span class="token punctuation">.</span>last_name<span class="token punctuation">,</span> a<span class="token punctuation">.</span>birth_date <span class="token keyword">FROM</span> t_actor a<span class="token punctuation">;</span>
<span class="token keyword">END</span><span class="token punctuation">;</span></code></pre>
<p>이 프로시저를 호출하려면 <code>RowMapper</code>를 선언하면 됩니다. 매핑하려는 클래스는 JavaBean 규칙을 따르므로 매핑할 필수 클래스를 <code>newInstance</code> 메서드에 전달하여 생성된 <code>BeanPropertyRowMapper</code>를 사용할 수 있습니다. 다음 예에서는 그 방법을 보여줍니다.</p>
<pre><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcActorDao</span> <span class="token keyword">implements</span> <span class="token class-name">ActorDao</span> <span class="token punctuation">{</span>

	<span class="token keyword">private</span> <span class="token class-name">SimpleJdbcCall</span> procReadAllActors<span class="token punctuation">;</span>

	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDataSource</span><span class="token punctuation">(</span><span class="token class-name">DataSource</span> dataSource<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">JdbcTemplate</span> jdbcTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JdbcTemplate</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span><span class="token punctuation">;</span>
		jdbcTemplate<span class="token punctuation">.</span><span class="token function">setResultsMapCaseInsensitive</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>procReadAllActors <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SimpleJdbcCall</span><span class="token punctuation">(</span>jdbcTemplate<span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">withProcedureName</span><span class="token punctuation">(</span><span class="token string">"read_all_actors"</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">returningResultSet</span><span class="token punctuation">(</span><span class="token string">"actors"</span><span class="token punctuation">,</span>
				<span class="token class-name">BeanPropertyRowMapper</span><span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token class-name">Actor</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">public</span> <span class="token class-name">List</span> <span class="token function">getActorsList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">Map</span> m <span class="token operator">=</span> procReadAllActors<span class="token punctuation">.</span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">List</span><span class="token punctuation">)</span> m<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">"actors"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// ... additional methods</span>
<span class="token punctuation">}</span></code></pre>
<p><code>execute</code> 호출은 매개변수를 사용하지 않기 때문에 빈 <code>Map</code>을 전달합니다. 그런 다음 행위자 목록이 결과 맵에서 검색되어 호출자에게 반환됩니다.</p>